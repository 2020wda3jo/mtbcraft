<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script	src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body>
	<h1>test.html페이지입니다.</h1>
	<h1>로컬테스트용입니다.</h1>
	<h1>테스트가 끝나면 지울 페이지입니다.</h1>

	<script>
		function uploadFile() {
			$.ajax({
				url : "/uploadFile",
				type : "POST",
				data : new FormData($("#upload-file-form")[0]),
				enctype : 'multipart/form-data',
				processData : false,
				contentType : false,
				cache : false,
				success : function() {
					alert('업로드 성공!');
				},
				error : function() {
					alert('업로드 실패..!');
				}
			});
		}
	</script>

	<form id="upload-file-form">
		<input type="text" name="extra"> <label
			for="upload-file-input">Upload your file:</label> <input
			id="upload-file-input" type="file" name="uploadfile" accept="*" />
		<button type="button" onclick="uploadFile();">업로드</button>
	</form>
	<h2>업로드 테스트 완료</h2>
	<hr>
	<h2>읽기 테스트 완료</h2>
	<button onclick="readGPX()">읽기</button>
	<hr>
	<h2>지도 위에 경로 올리기</h2>
	<div id="map" style="width:100%;height:500px;"></div>
	
	
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=75b139a908cf5a67ae5c093565896a18"></script>
	<script>
		var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
	    	mapOption = { 
	      	  	center: new kakao.maps.LatLng(35.89617906303501, 128.62171907592318), // 지도의 중심좌표
      			level: 5 // 지도의 확대 레벨
	    	};  
	
		var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
	
		// 선을 구성하는 좌표 배열입니다. 이 좌표들을 이어서 선을 표시합니다
		var linePath = [];
		
		
		
		function readGPX(){
			$.ajax({
				url : "/readgpx",
				type : "GET",
				cache : false,
				success : function(result){
					var point = result.infos;
					for(var i=0;i<point.length;i++){
						linePath.push(new kakao.maps.LatLng(point[i].lat, point[i].lon));
					}
					console.log(linePath);
					// 맵을 이동시킵니다.
					map.panTo(new kakao.maps.LatLng(point[0].lat, point[0].lon));
					
					// 지도에 표시할 선을 생성합니다
					var polyline = new kakao.maps.Polyline({
					    path: linePath, // 선을 구성하는 좌표배열 입니다
					    strokeWeight: 20, // 선의 두께 입니다
					    strokeColor: '#FFAE00', // 선의 색깔입니다
					    strokeOpacity: 1, // 선의 불투명도 입니다 1에서 0 사이의 값이며 0에 가까울수록 투명합니다
					    strokeStyle: 'solid' // 선의 스타일입니다
					});
					
					// 지도에 선을 표시합니다 
					polyline.setMap(map);
				} 
			});
		}
	</script>
</body>
</html>