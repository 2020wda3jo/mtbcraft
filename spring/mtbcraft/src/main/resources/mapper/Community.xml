<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mtbcraft.mapper.CommunityMapper">

	<!-- 클럽명 중복 검사 -->
	<select id="checkClubName" parameterType="String" resultType="Integer">
		SELECT count(*) FROM CLUB WHERE CB_NAME = #{cb_name}
	</select>
	
	<!-- 클럽 생성 -->
	<insert id="insertClub" parameterType="com.mtbcraft.dto.Club">
		insert into club(cb_num, cb_manager, cb_name, cb_image) values(SEQ_CLUBNUM.nextval, #{cb_manager}, #{cb_name}, #{cb_image})
	</insert>
	
	<!-- 클럽 가입 -->
	<insert id="insertCJ" parameterType="com.mtbcraft.dto.Club_Join">
		insert into club_join(cj_rider, cj_club, cj_join, cj_num) values(#{cj_rider}, SEQ_CLUBNUM.currval, (SYSDATE+9/24), SEQ_JOIN.nextval)
	</insert>
	
	<!-- 클럽 캘린더 일정 조회 -->
	<select id="getCCList" parameterType="int" resultType="com.mtbcraft.dto.Club_Calender">
		SELECT * FROM CLUB_CALENDER WHERE CC_CLUB=#{cc_club}
	</select>
	
	<!-- 클럽 캘린더 일정 등록 -->
	<insert id="postCC" parameterType="com.mtbcraft.dto.Club_Calender">
		INSERT INTO CLUB_CALENDER(CC_NUM,CC_CLUB,CC_RIDER, CC_CONTENT, CC_START, CC_END, CC_COLOR, CC_ALLDAY)
		VALUES(SEQ_CLUBCALENDER.NEXTVAL, #{cc_club}, #{cc_rider}, #{cc_content}, #{cc_start}, #{cc_end}, #{cc_color}, #{cc_allday})
	</insert>
	
	<!-- 클럽 캘린더 일정 수정 -->
	<update id="updateCC" parameterType="com.mtbcraft.dto.Club_Calender">
		UPDATE CLUB_CALENDER SET CC_CONTENT=#{cc_content}, CC_START=#{cc_start}, CC_END=#{cc_end}, CC_COLOR=#{cc_color}, CC_ALLDAY=#{cc_allday} WHERE CC_NUM=#{cc_num}
	</update>
	
	<!-- 클럽 캘린더 일정 삭제 -->
	<delete id="deleteCC" parameterType="int">
		DELETE FROM CLUB_CALENDER WHERE CC_NUM=#{cc_num}
	</delete>
	
	<select id="getMember" parameterType="int" resultType="com.mtbcraft.dto.Club">
		select * from club order by cb_num where cb_num=#{cb_num}
	</select>
	
	<select id="getClub" parameterType="String" resultType="com.mtbcraft.dto.Club">
		select * from club order by cb_num
	</select>	
	
	<insert id="signClub" parameterType="com.mtbcraft.dto.Club_Join">
		insert into club_join(cj_rider, cj_club, cj_join, cj_num) values(#{cj_rider}, #{cj_club}, (SYSDATE+9/24), SEQ_JOIN.nextval)
	</insert>
</mapper>

